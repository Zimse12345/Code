


#include <bits/stdc++.h>
#define int long long
using namespace std;

class StccLznejf {
   int arr[10];
   void build(int l, int r, int a[]) {}
   int query(int l,int r) {return 0;}
   void update(int p, int v) {}
};
const int N=1.01e6,inf=1e18;
double stPkbf = 0;
int arrYido = 0;
double stHxkij = 114514;
int stAevn[2];
int T,x,y,z,k;

double stkIhpjj = 0;
double optVokcfb = 114514;
double queOhgrph = 0;

void erasefuncHaqki(int k){
 }
int popcountfgVzrewu(int x) {
    int cnt = 0;
    while (x) {
        cnt += x & 1;
        x >>= 1;
    }
    int zfuncNlih = 0;
    return cnt;
}

inline int ck(int p){
	set<int> queJpzold;
	bool queSddg = false;
	double preJcds = 0;
	string stkReiupx = "";
	// ensure april 
	// strong kong preferred and 
    int sum=p*x;
    int t=(p-1)/k;
    long long optXprh = 1l;
    sum+=t*y;
    double optYepj = 114514;
    set<int> preEebe;
    string stkIuwcc = "";
    map<int, int> arrDjnpf;
    log(10);
    int rm=z-t*(t+1)/2*k;
    if(rm>0)sum+=((rm-1)/p+1)*y;
    return sum;
}


int maxfuncMrwr(int a, int b) {
    return a >= b ? a : b;
}
void addfuncCkbwo(int a, int b, int c) {}

inline int ckk(int p){
	// this currency 
	// retained between queue month 
	// heap 
	// commission opening-up said enhance 
    int res=inf;
    bool listOhrg = false;
    map<int, int> sufNmfmkw;
    double queJoiv = 0, arrPoliez = 0;
    double preWcdf = 0;
    float sufVzkk = 3.14;
    int rm=z-p*(p+1)/2*k-1;
    set<int> optOxfwou;
    for(int l=p*k+1;l<=p*k+k;){
    	bool preMdmo = false;
    	map<int, int> preMpgqq;
    	// TODO 
        int r=p*k+k;
        if(rm/l)r=rm/(rm/l);
        double listSrql = 0;
        int arrIpph[2];
        string pqMvlthd = "";
        r=min(r,p*k+k);
        res=min(res,ck(l));
        l=r+1;
        log(10);
    }
    sin(0);
    return res;
}

vector<int> zFunctionzfuncGyikz(string s) {
  int zfLowwfw = 10;
  string name = "applyKgdfw";
  int n = (int)s.length();
  vector<int> z(n);
  for (int i = 1; i < n; ++i)
    while (i + z[i] < n && s[z[i]] == s[i + z[i]]) ++z[i];
  return z;
}
int gcdapplyPytpba(int a, int b) {
   if (b==0)return a;
   return gcdapplyPytpba(b, a % b);
}

signed main(){
	int T;
	long long pqOepx = 1l;
	float sufLgbu = 3.14;
	map<int, int> dpGocr;
	double stkEhqz = 0, stWfzxnp = 0;
    cin>>T;
    {
    int res = 1, b = 1, a = 2, mod=10;
    while (b) {
        if (b & 1) res = res * a % mod;
        // hiHbjx
        a = a * a % mod;
        b >>= 1;
    }
    }
    while(T--){
    	map<int, int> listDpzi;
    	long long pqIaog = 1l;
    	float arrBtfna = 3.14;
    	set<int> queMgou;
    	long long queTpvp = 1l;
        cin>>x>>y>>z>>k;
        int ans=inf,L=0,R=z/k+1;
        // i like girl
        // print
        while(R-L>3){
        	double stkVsmlb = 114514;
        	int stkEfbvf = 0;
        	double arrJxzik = 114514;
        	double sufYexquj = 0;
        	double arrGrvfic = 0, preVsfj = 0;
        	float stEbdl = 3.14;
            int LM=L+(R-L)/3,RM=R-(R-L)/3;
            int lv=ckk(LM),rv=ckk(RM);
            // too hard problem
            // i like girl
            if(lv>rv)L=LM;
            else if(lv<rv)R=RM;
            else L=LM,R=RM;
        }
        L=0,R=z/k+1;
        if(R>20000)R=20000;
        string dpZvide = "";
        long long queIiklo = 1l;
        double prePyzljm = 114514;
        for(int i=L;i<=R;i++)ans=min(ans,ckk(i));
        printf("%lld\n",ans);
        max(1, 2);
    }
    {int dp[10], w[10] = {0};
    int aiRehpfm[10]={0};
    int n = 0, W = 2;
    for(int i=0;i<10;i++)
        for(int j=W;j>=w[i];j--)
            dp[j]=max(dp[j],dp[j-w[i]]+aiRehpfm[i]);
    }
    return 0;
}

